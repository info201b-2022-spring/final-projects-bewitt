---
title: "Exploratory Data Analysis"
output: html_document
date: '2022-05-20'
---
# Introduction

# Summary

# Table
```{table}
heart_data <- read.csv("/Users/jakeflynn/final-projects-bewitt/data/heart_2020_cleaned.csv")
# new data set for the heart health data that includes only columns of interest
heart_data_set <- select(heart_data, HeartDisease, Smoking, AlcoholDrinking, Stroke, AgeCategory)
# new data set that is grouped by age category
grouped <- group_by(heart_data_set, AgeCategory)
# Convert HeartDisease, Stroke, Smoking, and AlcoholDrinking columns to values that can be summed
grouped$HeartDisease <- ifelse(grouped$HeartDisease=="Yes", 1, 0)
grouped$Stroke<-ifelse(grouped$Stroke=="Yes", 1, 0)
grouped$Smoking<-ifelse(grouped$Smoking=="Yes", 1, 0)
grouped$AlcoholDrinking<-ifelse(grouped$AlcoholDrinking=="Yes", 1, 0)
# Include proportion of people who have reported heart disease or a stroke for their age category
aggregate_table <- summarize(grouped, heart_disease_prop = format(sum(HeartDisease) / length(HeartDisease), digits = 2),
                             stroke_prop = format(sum(Stroke) / length(Stroke), digits = 2),
                             smoke_prop = format(sum(Smoking) / length(Smoking), digits = 2),
                             alcohol_prop = format(sum(AlcoholDrinking) / length(AlcoholDrinking), digits = 2))
# Create human readable column names
colnames(aggregate_table) <- c("Age Category", "Heart Disease Proportion", "Stroke Proportion", "Smoking Proportion", "Alcohol Drinking Proportion")
```

# Bar Chart of Heart Disease by Age Grouped
```{bar, echo = FALSE}
# load the data set and package
library(dplyr)
library(ggplot2)
heart_data <- read.csv("/Users/jakeflynn/final-projects-bewitt/data/heart_2020_cleaned.csv")
# new data set that is grouped by age category
grouped <- group_by(heart_data, AgeCategory)
# Convert HeartDisease to values that can be summed
grouped$HeartDisease<-ifelse(grouped$HeartDisease=="Yes", 1, 0)
# Include proportion of people who have reported heart disease for their age category
heart_disease_age <- summarize(grouped, heart_disease_prop = format(sum(HeartDisease) / length(HeartDisease), digits = 2))
heart_disease_age_barplot <- heart_disease_age %>%
  # First sort by `heart_disease_prop`. This sorts the data frame but NOT the factor levels.
  arrange(heart_disease_prop) %>%
  # This trick updates the factor levels.
  mutate(AgeCategory=factor(AgeCategory, levels=AgeCategory)) %>%
  ggplot(aes(x=AgeCategory, y=heart_disease_prop)) +
  geom_bar(stat = "identity", fill="#f68060", alpha=.6, width=.4)
# Call bar plot
heart_disease_age_barplot +
  coord_flip() +
  xlab("Age Category (years)") +
  ylab("Proportion of Age Category With Heart Disease") +
  theme(axis.text.x = element_text(angle = 90)) +
  ggtitle("Proportion of Americans With\nHeart Disease by Age Category (2020)")
```
Explanation Paragraph

# Pie Chart of People With Heart Disease Based on Sex (M or F)
```{pie, echo = FALSE}
library(tidyverse)
library(dplyr)
heart_df <- read.csv("/Users/jacksonkamins/Desktop/INFO 201/final-projects-bewitt/data/heart_2020_cleaned.csv")
heart_df$HeartDisease <- ifelse(heart_df$HeartDisease == "Yes", 1,0)
heart_disease_by_sex <- group_by(heart_df, Sex)
sex_heart_disease <- summarise(heart_disease_by_sex, total_disease = sum(HeartDisease))
#Create Pie Chart
slices <- c(sex_heart_disease$total_disease)
lbls <- c(slices)
lbls <- paste(lbls, sex_heart_disease$Sex)
lbls <- paste(lbls, "Deaths of Heart Disease")
pie(slices, labels = lbls, main = "Pie Chart of Sex and Risk of Heart Disease")
```
Explanation Paragraph

# Chart 3


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
